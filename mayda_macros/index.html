<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="rustdoc">
    <meta name="description" content="API documentation for the Rust `mayda_macros` crate.">
    <meta name="keywords" content="rust, rustlang, rust-lang, mayda_macros">

    <title>mayda_macros - Rust</title>

    <link rel="stylesheet" type="text/css" href="../rustdoc.css">
    <link rel="stylesheet" type="text/css" href="../main.css">
    

    
    
</head>
<body class="rustdoc">
    <!--[if lte IE 8]>
    <div class="warning">
        This old browser is unsupported and will most likely display funky
        things.
    </div>
    <![endif]-->

    

    <nav class="sidebar">
        
        <p class='location'></p><script>window.sidebarCurrent = {name: 'mayda_macros', ty: 'mod', relpath: '../'};</script>
    </nav>

    <nav class="sub">
        <form class="search-form js-only">
            <div class="search-container">
                <input class="search-input" name="search"
                       autocomplete="off"
                       placeholder="Click or press ‘S’ to search, ‘?’ for more options…"
                       type="search">
            </div>
        </form>
    </nav>

    <section id='main' class="content mod">
<h1 class='fqn'><span class='in-band'>Crate <a class='mod' href=''>mayda_macros</a></span><span class='out-of-band'><span id='render-detail'>
                   <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">
                       [<span class='inner'>&#x2212;</span>]
                   </a>
               </span><a id='src-0' class='srclink' href='../src/mayda_macros/mayda_macros/src/lib.rs.html#8-993' title='goto source code'>[src]</a></span></h1>
<div class='docblock'><p>Compiler plugins to generate basic encoding and decoding functions. The
functions generated by the <code>encode!</code> and <code>decode!</code> syntax extensions follow
the convention <code>encode_T_a_b</code>. The functions generated by the
<code>encode_simd!</code> and <code>decode_simd!</code> syntax extensions follow the convention
<code>encode_simd_T_a</code>. The functions generated by the <code>encode_util!</code> syntax
extention follow the conventions <code>encode_delta_T</code> and <code>encode_zz_shift_T</code>.
<code>T</code> is one of the unsigned integer types, <code>a</code> is the number of bits per
integer, and <code>b</code> is the number of integers encoded.</p>

<p><code>encode!</code> and <code>decode!</code> take as arguments the unsigned integer type width
in bits and a step for the number of integers (a divisor of 32).  Functions
are generated for numbers of bits in the interval <code>0...max_bits</code>, and for
numbers of integers in multiples of the step up to 32. <code>encode_simd!</code> and
<code>decode_simd!</code> take as arguments the unsigned integer type width in bits
and a path to the relevant simd module. Functions are generated for numbers
of bits in the interval <code>0...max_bits</code>, and for exactly 128 integers.
<code>encode_util!</code> takes as arguments the unsigned integer type width in bits
and a path to the relevant simd module. Functions are generated for the
type width and for an arbitrary number of integers.</p>

<p>Pointers to the functions generated by <code>encode!</code> and <code>decode!</code> are
available in <code>ENCODE_T</code> and <code>DECODE_T</code>, respectively, with the pointer for
<code>encode_T_a_b</code> at <code>ENCODE_T[a][b / c - 1]</code> where <code>c</code> is the step.
Pointers to the functions generated by <code>encode_simd!</code> and <code>decode_simd!</code>
are availabe in <code>ENCODE_SIMD_T</code> and <code>DECODE_SIMD_T</code>, respectively, with the
pointer for <code>encode_simd_T_a</code> at <code>ENCODE_SIMD_T[a]</code>. The functions
generated by <code>encode_util!</code> are public. All arrays are public and constant.</p>

<h1 id='safety' class='section-header'><a href='#safety'>Safety</a></h1>
<p>The functions generated by this crate use wildly unsafe pointer operations.
You must verify that enough memory is already allocated after the pointers
that the offsets are valid. They are not intended to be used outside the
<code>mayda</code> crate.</p>

<h1 id='examples' class='section-header'><a href='#examples'>Examples</a></h1>
<p>The syntax extensions defined in this crate can be invoked as</p>

<pre class='rust rust-example-rendered'>
<span class='macro'>encode</span><span class='macro'>!</span>(<span class='ident'>u32</span>, <span class='number'>32</span>, <span class='number'>8</span>);
<span class='macro'>decode</span><span class='macro'>!</span>(<span class='ident'>u32</span>, <span class='number'>32</span>, <span class='number'>8</span>);</pre>

<p>This is replaced by 128 functions that encode u32 integers and 128
functions that decode u32 integers. For example, the functions that encode
and decode the 24 least significant bits of 8 u32 integers are</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>unsafe</span> <span class='kw'>fn</span> <span class='ident'>encode_u32_24_8</span>(<span class='kw-2'>mut</span> <span class='ident'>i_ptr</span>: <span class='op'>*</span><span class='kw'>const</span> <span class='ident'>u32</span>, <span class='kw-2'>mut</span> <span class='ident'>s_ptr</span>: <span class='op'>*</span><span class='kw-2'>mut</span> <span class='ident'>u32</span>) {
    <span class='kw'>let</span> <span class='kw-2'>mut</span> <span class='ident'>out</span> <span class='op'>=</span> <span class='op'>*</span><span class='ident'>i_ptr</span> <span class='kw'>as</span> <span class='ident'>u32</span>;
    <span class='ident'>i_ptr</span> <span class='op'>=</span> <span class='ident'>i_ptr</span>.<span class='ident'>offset</span>(<span class='number'>1</span>);
    <span class='ident'>out</span> <span class='op'>|=</span> (<span class='op'>*</span><span class='ident'>i_ptr</span> <span class='kw'>as</span> <span class='ident'>u32</span>) <span class='op'>&lt;&lt;</span> <span class='number'>24usize</span>;
    <span class='op'>*</span><span class='ident'>s_ptr</span> <span class='op'>=</span> <span class='ident'>out</span>;
    <span class='ident'>s_ptr</span> <span class='op'>=</span> <span class='ident'>s_ptr</span>.<span class='ident'>offset</span>(<span class='number'>1</span>);
    <span class='ident'>out</span> <span class='op'>=</span> (<span class='op'>*</span><span class='ident'>i_ptr</span> <span class='op'>&gt;&gt;</span> <span class='number'>8usize</span>) <span class='kw'>as</span> <span class='ident'>u32</span>;
    <span class='ident'>i_ptr</span> <span class='op'>=</span> <span class='ident'>i_ptr</span>.<span class='ident'>offset</span>(<span class='number'>1</span>);
    <span class='ident'>out</span> <span class='op'>|=</span> (<span class='op'>*</span><span class='ident'>i_ptr</span> <span class='kw'>as</span> <span class='ident'>u32</span>) <span class='op'>&lt;&lt;</span> <span class='number'>16usize</span>;
    <span class='op'>*</span><span class='ident'>s_ptr</span> <span class='op'>=</span> <span class='ident'>out</span>;
    <span class='ident'>s_ptr</span> <span class='op'>=</span> <span class='ident'>s_ptr</span>.<span class='ident'>offset</span>(<span class='number'>1</span>);
    <span class='ident'>out</span> <span class='op'>=</span> (<span class='op'>*</span><span class='ident'>i_ptr</span> <span class='op'>&gt;&gt;</span> <span class='number'>16usize</span>) <span class='kw'>as</span> <span class='ident'>u32</span>;
    <span class='ident'>i_ptr</span> <span class='op'>=</span> <span class='ident'>i_ptr</span>.<span class='ident'>offset</span>(<span class='number'>1</span>);
    <span class='ident'>out</span> <span class='op'>|=</span> (<span class='op'>*</span><span class='ident'>i_ptr</span> <span class='kw'>as</span> <span class='ident'>u32</span>) <span class='op'>&lt;&lt;</span> <span class='number'>8usize</span>;
    <span class='ident'>i_ptr</span> <span class='op'>=</span> <span class='ident'>i_ptr</span>.<span class='ident'>offset</span>(<span class='number'>1</span>);
    <span class='op'>*</span><span class='ident'>s_ptr</span> <span class='op'>=</span> <span class='ident'>out</span>;
    <span class='ident'>s_ptr</span> <span class='op'>=</span> <span class='ident'>s_ptr</span>.<span class='ident'>offset</span>(<span class='number'>1</span>);
    <span class='ident'>out</span> <span class='op'>=</span> <span class='op'>*</span><span class='ident'>i_ptr</span> <span class='kw'>as</span> <span class='ident'>u32</span>;
    <span class='ident'>i_ptr</span> <span class='op'>=</span> <span class='ident'>i_ptr</span>.<span class='ident'>offset</span>(<span class='number'>1</span>);
    <span class='ident'>out</span> <span class='op'>|=</span> (<span class='op'>*</span><span class='ident'>i_ptr</span> <span class='kw'>as</span> <span class='ident'>u32</span>) <span class='op'>&lt;&lt;</span> <span class='number'>24usize</span>;
    <span class='op'>*</span><span class='ident'>s_ptr</span> <span class='op'>=</span> <span class='ident'>out</span>;
    <span class='ident'>s_ptr</span> <span class='op'>=</span> <span class='ident'>s_ptr</span>.<span class='ident'>offset</span>(<span class='number'>1</span>);
    <span class='ident'>out</span> <span class='op'>=</span> (<span class='op'>*</span><span class='ident'>i_ptr</span> <span class='op'>&gt;&gt;</span> <span class='number'>8usize</span>) <span class='kw'>as</span> <span class='ident'>u32</span>;
    <span class='ident'>i_ptr</span> <span class='op'>=</span> <span class='ident'>i_ptr</span>.<span class='ident'>offset</span>(<span class='number'>1</span>);
    <span class='ident'>out</span> <span class='op'>|=</span> (<span class='op'>*</span><span class='ident'>i_ptr</span> <span class='kw'>as</span> <span class='ident'>u32</span>) <span class='op'>&lt;&lt;</span> <span class='number'>16usize</span>;
    <span class='op'>*</span><span class='ident'>s_ptr</span> <span class='op'>=</span> <span class='ident'>out</span>;
    <span class='ident'>s_ptr</span> <span class='op'>=</span> <span class='ident'>s_ptr</span>.<span class='ident'>offset</span>(<span class='number'>1</span>);
    <span class='ident'>out</span> <span class='op'>=</span> (<span class='op'>*</span><span class='ident'>i_ptr</span> <span class='op'>&gt;&gt;</span> <span class='number'>16usize</span>) <span class='kw'>as</span> <span class='ident'>u32</span>;
    <span class='ident'>i_ptr</span> <span class='op'>=</span> <span class='ident'>i_ptr</span>.<span class='ident'>offset</span>(<span class='number'>1</span>);
    <span class='ident'>out</span> <span class='op'>|=</span> (<span class='op'>*</span><span class='ident'>i_ptr</span> <span class='kw'>as</span> <span class='ident'>u32</span>) <span class='op'>&lt;&lt;</span> <span class='number'>8usize</span>;
    <span class='op'>*</span><span class='ident'>s_ptr</span> <span class='op'>=</span> <span class='ident'>out</span>;
}

<span class='kw'>unsafe</span> <span class='kw'>fn</span> <span class='ident'>decode_u32_24_8</span>(<span class='kw-2'>mut</span> <span class='ident'>s_ptr</span>: <span class='op'>*</span><span class='kw'>const</span> <span class='ident'>u32</span>, <span class='kw-2'>mut</span> <span class='ident'>o_ptr</span>: <span class='op'>*</span><span class='kw-2'>mut</span> <span class='ident'>u32</span>) {
    <span class='kw'>let</span> <span class='ident'>mask</span>: <span class='ident'>u32</span> <span class='op'>=</span> <span class='op'>!</span><span class='number'>0</span> <span class='op'>&gt;&gt;</span> <span class='number'>8usize</span>;
    <span class='kw'>let</span> <span class='kw-2'>mut</span> <span class='ident'>out</span>;
    <span class='ident'>out</span> <span class='op'>=</span> <span class='op'>*</span><span class='ident'>s_ptr</span> <span class='kw'>as</span> <span class='ident'>u32</span>;
    <span class='op'>*</span><span class='ident'>o_ptr</span> <span class='op'>=</span> <span class='ident'>out</span> <span class='kw-2'>&amp;</span> <span class='ident'>mask</span>;
    <span class='ident'>o_ptr</span> <span class='op'>=</span> <span class='ident'>o_ptr</span>.<span class='ident'>offset</span>(<span class='number'>1</span>);
    <span class='ident'>out</span> <span class='op'>=</span> (<span class='op'>*</span><span class='ident'>s_ptr</span> <span class='op'>&gt;&gt;</span> <span class='number'>24usize</span>) <span class='kw'>as</span> <span class='ident'>u32</span>;
    <span class='ident'>s_ptr</span> <span class='op'>=</span> <span class='ident'>s_ptr</span>.<span class='ident'>offset</span>(<span class='number'>1</span>);
    <span class='ident'>out</span> <span class='op'>|=</span> (<span class='op'>*</span><span class='ident'>s_ptr</span> <span class='kw'>as</span> <span class='ident'>u32</span>) <span class='op'>&lt;&lt;</span> <span class='number'>8usize</span>;
    <span class='op'>*</span><span class='ident'>o_ptr</span> <span class='op'>=</span> <span class='ident'>out</span> <span class='kw-2'>&amp;</span> <span class='ident'>mask</span>;
    <span class='ident'>o_ptr</span> <span class='op'>=</span> <span class='ident'>o_ptr</span>.<span class='ident'>offset</span>(<span class='number'>1</span>);
    <span class='ident'>out</span> <span class='op'>=</span> (<span class='op'>*</span><span class='ident'>s_ptr</span> <span class='op'>&gt;&gt;</span> <span class='number'>16usize</span>) <span class='kw'>as</span> <span class='ident'>u32</span>;
    <span class='ident'>s_ptr</span> <span class='op'>=</span> <span class='ident'>s_ptr</span>.<span class='ident'>offset</span>(<span class='number'>1</span>);
    <span class='ident'>out</span> <span class='op'>|=</span> (<span class='op'>*</span><span class='ident'>s_ptr</span> <span class='kw'>as</span> <span class='ident'>u32</span>) <span class='op'>&lt;&lt;</span> <span class='number'>16usize</span>;
    <span class='op'>*</span><span class='ident'>o_ptr</span> <span class='op'>=</span> <span class='ident'>out</span> <span class='kw-2'>&amp;</span> <span class='ident'>mask</span>;
    <span class='ident'>o_ptr</span> <span class='op'>=</span> <span class='ident'>o_ptr</span>.<span class='ident'>offset</span>(<span class='number'>1</span>);
    <span class='ident'>out</span> <span class='op'>=</span> (<span class='op'>*</span><span class='ident'>s_ptr</span> <span class='op'>&gt;&gt;</span> <span class='number'>8usize</span>) <span class='kw'>as</span> <span class='ident'>u32</span>;
    <span class='op'>*</span><span class='ident'>o_ptr</span> <span class='op'>=</span> <span class='ident'>out</span> <span class='kw-2'>&amp;</span> <span class='ident'>mask</span>;
    <span class='ident'>o_ptr</span> <span class='op'>=</span> <span class='ident'>o_ptr</span>.<span class='ident'>offset</span>(<span class='number'>1</span>);
    <span class='ident'>s_ptr</span> <span class='op'>=</span> <span class='ident'>s_ptr</span>.<span class='ident'>offset</span>(<span class='number'>1</span>);
    <span class='ident'>out</span> <span class='op'>=</span> <span class='op'>*</span><span class='ident'>s_ptr</span> <span class='kw'>as</span> <span class='ident'>u32</span>;
    <span class='op'>*</span><span class='ident'>o_ptr</span> <span class='op'>=</span> <span class='ident'>out</span> <span class='kw-2'>&amp;</span> <span class='ident'>mask</span>;
    <span class='ident'>o_ptr</span> <span class='op'>=</span> <span class='ident'>o_ptr</span>.<span class='ident'>offset</span>(<span class='number'>1</span>);
    <span class='ident'>out</span> <span class='op'>=</span> (<span class='op'>*</span><span class='ident'>s_ptr</span> <span class='op'>&gt;&gt;</span> <span class='number'>24usize</span>) <span class='kw'>as</span> <span class='ident'>u32</span>;
    <span class='ident'>s_ptr</span> <span class='op'>=</span> <span class='ident'>s_ptr</span>.<span class='ident'>offset</span>(<span class='number'>1</span>);
    <span class='ident'>out</span> <span class='op'>|=</span> (<span class='op'>*</span><span class='ident'>s_ptr</span> <span class='kw'>as</span> <span class='ident'>u32</span>) <span class='op'>&lt;&lt;</span> <span class='number'>8usize</span>;
    <span class='op'>*</span><span class='ident'>o_ptr</span> <span class='op'>=</span> <span class='ident'>out</span> <span class='kw-2'>&amp;</span> <span class='ident'>mask</span>;
    <span class='ident'>o_ptr</span> <span class='op'>=</span> <span class='ident'>o_ptr</span>.<span class='ident'>offset</span>(<span class='number'>1</span>);
    <span class='ident'>out</span> <span class='op'>=</span> (<span class='op'>*</span><span class='ident'>s_ptr</span> <span class='op'>&gt;&gt;</span> <span class='number'>16usize</span>) <span class='kw'>as</span> <span class='ident'>u32</span>;
    <span class='ident'>s_ptr</span> <span class='op'>=</span> <span class='ident'>s_ptr</span>.<span class='ident'>offset</span>(<span class='number'>1</span>);
    <span class='ident'>out</span> <span class='op'>|=</span> (<span class='op'>*</span><span class='ident'>s_ptr</span> <span class='kw'>as</span> <span class='ident'>u32</span>) <span class='op'>&lt;&lt;</span> <span class='number'>16usize</span>;
    <span class='op'>*</span><span class='ident'>o_ptr</span> <span class='op'>=</span> <span class='ident'>out</span> <span class='kw-2'>&amp;</span> <span class='ident'>mask</span>;
    <span class='ident'>o_ptr</span> <span class='op'>=</span> <span class='ident'>o_ptr</span>.<span class='ident'>offset</span>(<span class='number'>1</span>);
    <span class='ident'>out</span> <span class='op'>=</span> (<span class='op'>*</span><span class='ident'>s_ptr</span> <span class='op'>&gt;&gt;</span> <span class='number'>8usize</span>) <span class='kw'>as</span> <span class='ident'>u32</span>;
    <span class='op'>*</span><span class='ident'>o_ptr</span> <span class='op'>=</span> <span class='ident'>out</span> <span class='kw-2'>&amp;</span> <span class='ident'>mask</span>;
}</pre>
</div><h2 id='functions' class='section-header'><a href="#functions">Functions</a></h2>
<table>
                       <tr class=' module-item'>
                           <td><a class='fn' href='fn.plugin_registrar.html'
                                  title='mayda_macros::plugin_registrar'>plugin_registrar</a></td>
                           <td class='docblock short'>
                                <p>Registers the encode and decode syntax expansions.</p>
                           </td>
                       </tr></table></section>
    <section id='search' class="content hidden"></section>

    <section class="footer"></section>

    <aside id="help" class="hidden">
        <div>
            <h1 class="hidden">Help</h1>

            <div class="shortcuts">
                <h2>Keyboard Shortcuts</h2>

                <dl>
                    <dt>?</dt>
                    <dd>Show this help dialog</dd>
                    <dt>S</dt>
                    <dd>Focus the search field</dd>
                    <dt>&larrb;</dt>
                    <dd>Move up in search results</dd>
                    <dt>&rarrb;</dt>
                    <dd>Move down in search results</dd>
                    <dt>&#9166;</dt>
                    <dd>Go to active search result</dd>
                    <dt>+</dt>
                    <dd>Collapse/expand all sections</dd>
                </dl>
            </div>

            <div class="infos">
                <h2>Search Tricks</h2>

                <p>
                    Prefix searches with a type followed by a colon (e.g.
                    <code>fn:</code>) to restrict the search to a given type.
                </p>

                <p>
                    Accepted types are: <code>fn</code>, <code>mod</code>,
                    <code>struct</code>, <code>enum</code>,
                    <code>trait</code>, <code>type</code>, <code>macro</code>,
                    and <code>const</code>.
                </p>

                <p>
                    Search functions by type signature (e.g.
                    <code>vec -> usize</code> or <code>* -> vec</code>)
                </p>
            </div>
        </div>
    </aside>

    

    <script>
        window.rootPath = "../";
        window.currentCrate = "mayda_macros";
        window.playgroundUrl = "";
    </script>
    <script src="../jquery.js"></script>
    <script src="../main.js"></script>
    
    <script defer src="../search-index.js"></script>
</body>
</html>